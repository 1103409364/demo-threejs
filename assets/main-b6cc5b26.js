/* empty css              */import{a9 as Ht,V as a,ab as at,Q as g,aa as bt,M as St,L as Zt,ac as w,B as d,c as ct,ad as pt,a as i,ae as J,d as I,b as Tt,K as k,i as zt,D as Dt,a7 as jt,S as qt,A as Lt,P as kt,W as Wt,af as Rt}from"./three.module-d5fa3ebf.js";import{S as Ct}from"./Stats-ef6ecf20.js";import{G as Gt}from"./lil-gui.esm-fc0b5e43.js";const H=new Ht,f=new a,Q=new a,c=new g,dt={X:new a(1,0,0),Y:new a(0,1,0),Z:new a(0,0,1)},ot={type:"change"},mt={type:"mouseDown"},ut={type:"mouseUp",mode:null},wt={type:"objectChange"};class Ot extends at{constructor(s,o){super(),o===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),o=document),this.isTransformControls=!0,this.visible=!1,this.domElement=o,this.domElement.style.touchAction="none";const n=new Vt;this._gizmo=n,this.add(n);const e=new Jt;this._plane=e,this.add(e);const h=this;function t(m,_){let z=_;Object.defineProperty(h,m,{get:function(){return z!==void 0?z:_},set:function(Y){z!==Y&&(z=Y,e[m]=Y,n[m]=Y,h.dispatchEvent({type:m+"-changed",value:Y}),h.dispatchEvent(ot))}}),h[m]=_,e[m]=_,n[m]=_}t("camera",s),t("object",void 0),t("enabled",!0),t("axis",null),t("mode","translate"),t("translationSnap",null),t("rotationSnap",null),t("scaleSnap",null),t("space","world"),t("size",1),t("dragging",!1),t("showX",!0),t("showY",!0),t("showZ",!0);const p=new a,M=new a,A=new g,T=new g,q=new a,L=new g,lt=new a,B=new a,x=new a,v=0,S=new a;t("worldPosition",p),t("worldPositionStart",M),t("worldQuaternion",A),t("worldQuaternionStart",T),t("cameraPosition",q),t("cameraQuaternion",L),t("pointStart",lt),t("pointEnd",B),t("rotationAxis",x),t("rotationAngle",v),t("eye",S),this._offset=new a,this._startNorm=new a,this._endNorm=new a,this._cameraScale=new a,this._parentPosition=new a,this._parentQuaternion=new g,this._parentQuaternionInv=new g,this._parentScale=new a,this._worldScaleStart=new a,this._worldQuaternionInv=new g,this._worldScale=new a,this._positionStart=new a,this._quaternionStart=new g,this._scaleStart=new a,this._getPointer=Ft.bind(this),this._onPointerDown=Ut.bind(this),this._onPointerHover=Bt.bind(this),this._onPointerMove=Nt.bind(this),this._onPointerUp=Kt.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(s){if(this.object===void 0||this.dragging===!0)return;H.setFromCamera(s,this.camera);const o=st(this._gizmo.picker[this.mode],H);o?this.axis=o.object.name:this.axis=null}pointerDown(s){if(!(this.object===void 0||this.dragging===!0||s.button!==0)&&this.axis!==null){H.setFromCamera(s,this.camera);const o=st(this._plane,H,!0);o&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(o.point).sub(this.worldPositionStart)),this.dragging=!0,mt.mode=this.mode,this.dispatchEvent(mt)}}pointerMove(s){const o=this.axis,n=this.mode,e=this.object;let h=this.space;if(n==="scale"?h="local":(o==="E"||o==="XYZE"||o==="XYZ")&&(h="world"),e===void 0||o===null||this.dragging===!1||s.button!==-1)return;H.setFromCamera(s,this.camera);const t=st(this._plane,H,!0);if(t){if(this.pointEnd.copy(t.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),h==="local"&&o!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),o.indexOf("X")===-1&&(this._offset.x=0),o.indexOf("Y")===-1&&(this._offset.y=0),o.indexOf("Z")===-1&&(this._offset.z=0),h==="local"&&o!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),e.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(h==="local"&&(e.position.applyQuaternion(c.copy(this._quaternionStart).invert()),o.search("X")!==-1&&(e.position.x=Math.round(e.position.x/this.translationSnap)*this.translationSnap),o.search("Y")!==-1&&(e.position.y=Math.round(e.position.y/this.translationSnap)*this.translationSnap),o.search("Z")!==-1&&(e.position.z=Math.round(e.position.z/this.translationSnap)*this.translationSnap),e.position.applyQuaternion(this._quaternionStart)),h==="world"&&(e.parent&&e.position.add(f.setFromMatrixPosition(e.parent.matrixWorld)),o.search("X")!==-1&&(e.position.x=Math.round(e.position.x/this.translationSnap)*this.translationSnap),o.search("Y")!==-1&&(e.position.y=Math.round(e.position.y/this.translationSnap)*this.translationSnap),o.search("Z")!==-1&&(e.position.z=Math.round(e.position.z/this.translationSnap)*this.translationSnap),e.parent&&e.position.sub(f.setFromMatrixPosition(e.parent.matrixWorld))));else if(n==="scale"){if(o.search("XYZ")!==-1){let p=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(p*=-1),Q.set(p,p,p)}else f.copy(this.pointStart),Q.copy(this.pointEnd),f.applyQuaternion(this._worldQuaternionInv),Q.applyQuaternion(this._worldQuaternionInv),Q.divide(f),o.search("X")===-1&&(Q.x=1),o.search("Y")===-1&&(Q.y=1),o.search("Z")===-1&&(Q.z=1);e.scale.copy(this._scaleStart).multiply(Q),this.scaleSnap&&(o.search("X")!==-1&&(e.scale.x=Math.round(e.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),o.search("Y")!==-1&&(e.scale.y=Math.round(e.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),o.search("Z")!==-1&&(e.scale.z=Math.round(e.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const p=20/this.worldPosition.distanceTo(f.setFromMatrixPosition(this.camera.matrixWorld));o==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):o==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(f.copy(this.rotationAxis).cross(this.eye))*p):(o==="X"||o==="Y"||o==="Z")&&(this.rotationAxis.copy(dt[o]),f.copy(dt[o]),h==="local"&&f.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(f.cross(this.eye).normalize())*p),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),h==="local"&&o!=="E"&&o!=="XYZE"?(e.quaternion.copy(this._quaternionStart),e.quaternion.multiply(c.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),e.quaternion.copy(c.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),e.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(ot),this.dispatchEvent(wt)}}pointerUp(s){s.button===0&&(this.dragging&&this.axis!==null&&(ut.mode=this.mode,this.dispatchEvent(ut)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(s){s.geometry&&s.geometry.dispose(),s.material&&s.material.dispose()})}attach(s){return this.object=s,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(ot),this.dispatchEvent(wt),this.pointStart.copy(this.pointEnd))}getRaycaster(){return H}getMode(){return this.mode}setMode(s){this.mode=s}setTranslationSnap(s){this.translationSnap=s}setRotationSnap(s){this.rotationSnap=s}setScaleSnap(s){this.scaleSnap=s}setSize(s){this.size=s}setSpace(s){this.space=s}}function Ft(r){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:r.button};{const s=this.domElement.getBoundingClientRect();return{x:(r.clientX-s.left)/s.width*2-1,y:-(r.clientY-s.top)/s.height*2+1,button:r.button}}}function Bt(r){if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(r));break}}function Ut(r){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(r)),this.pointerDown(this._getPointer(r)))}function Nt(r){this.enabled&&this.pointerMove(this._getPointer(r))}function Kt(r){this.enabled&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(r)))}function st(r,s,o){const n=s.intersectObject(r,!0);for(let e=0;e<n.length;e++)if(n[e].object.visible||o)return n[e];return!1}const $=new jt,l=new a(0,1,0),ft=new a(0,0,0),yt=new bt,tt=new g,it=new g,P=new a,_t=new bt,C=new a(1,0,0),Z=new a(0,1,0),G=new a(0,0,1),et=new a,W=new a,R=new a;class Vt extends at{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const s=new St({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=new Zt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=s.clone();n.opacity=.15;const e=o.clone();e.opacity=.5;const h=s.clone();h.color.setHex(16711680);const t=s.clone();t.color.setHex(65280);const p=s.clone();p.color.setHex(255);const M=s.clone();M.color.setHex(16711680),M.opacity=.5;const A=s.clone();A.color.setHex(65280),A.opacity=.5;const T=s.clone();T.color.setHex(255),T.opacity=.5;const q=s.clone();q.opacity=.25;const L=s.clone();L.color.setHex(16776960),L.opacity=.25,s.clone().color.setHex(16776960);const B=s.clone();B.color.setHex(7895160);const x=new w(0,.04,.1,12);x.translate(0,.05,0);const v=new d(.08,.08,.08);v.translate(0,.04,0);const S=new ct;S.setAttribute("position",new pt([0,0,0,1,0,0],3));const m=new w(.0075,.0075,.5,3);m.translate(0,.25,0);function _(y,U){const b=new k(y,.0075,3,64,U*Math.PI*2);return b.rotateY(Math.PI/2),b.rotateX(Math.PI/2),b}function z(){const y=new ct;return y.setAttribute("position",new pt([0,0,0,1,1,1],3)),y}const Y={X:[[new i(x,h),[.5,0,0],[0,0,-Math.PI/2]],[new i(x,h),[-.5,0,0],[0,0,Math.PI/2]],[new i(m,h),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new i(x,t),[0,.5,0]],[new i(x,t),[0,-.5,0],[Math.PI,0,0]],[new i(m,t)]],Z:[[new i(x,p),[0,0,.5],[Math.PI/2,0,0]],[new i(x,p),[0,0,-.5],[-Math.PI/2,0,0]],[new i(m,p),null,[Math.PI/2,0,0]]],XYZ:[[new i(new J(.1,0),q.clone()),[0,0,0]]],XY:[[new i(new d(.15,.15,.01),T.clone()),[.15,.15,0]]],YZ:[[new i(new d(.15,.15,.01),M.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i(new d(.15,.15,.01),A.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},Mt={X:[[new i(new w(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new i(new w(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new i(new w(.2,0,.6,4),n),[0,.3,0]],[new i(new w(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new i(new w(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new i(new w(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new i(new J(.2,0),n)]],XY:[[new i(new d(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new i(new d(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i(new d(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},xt={START:[[new i(new J(.01,2),e),null,null,null,"helper"]],END:[[new i(new J(.01,2),e),null,null,null,"helper"]],DELTA:[[new I(z(),e),null,null,null,"helper"]],X:[[new I(S,e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new I(S,e.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new I(S,e.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},vt={XYZE:[[new i(_(.5,1),B),null,[0,Math.PI/2,0]]],X:[[new i(_(.5,.5),h)]],Y:[[new i(_(.5,.5),t),null,[0,0,-Math.PI/2]]],Z:[[new i(_(.5,.5),p),null,[0,Math.PI/2,0]]],E:[[new i(_(.75,1),L),null,[0,Math.PI/2,0]]]},Et={AXIS:[[new I(S,e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},It={XYZE:[[new i(new Tt(.25,10,8),n)]],X:[[new i(new k(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new i(new k(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new i(new k(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new i(new k(.75,.1,2,24),n)]]},Qt={X:[[new i(v,h),[.5,0,0],[0,0,-Math.PI/2]],[new i(m,h),[0,0,0],[0,0,-Math.PI/2]],[new i(v,h),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new i(v,t),[0,.5,0]],[new i(m,t)],[new i(v,t),[0,-.5,0],[0,0,Math.PI]]],Z:[[new i(v,p),[0,0,.5],[Math.PI/2,0,0]],[new i(m,p),[0,0,0],[Math.PI/2,0,0]],[new i(v,p),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new i(new d(.15,.15,.01),T),[.15,.15,0]]],YZ:[[new i(new d(.15,.15,.01),M),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i(new d(.15,.15,.01),A),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new i(new d(.1,.1,.1),q.clone())]]},Xt={X:[[new i(new w(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new i(new w(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new i(new w(.2,0,.6,4),n),[0,.3,0]],[new i(new w(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new i(new w(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new i(new w(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new i(new d(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new i(new d(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i(new d(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new i(new d(.2,.2,.2),n),[0,0,0]]]},At={X:[[new I(S,e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new I(S,e.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new I(S,e.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function E(y){const U=new at;for(const b in y)for(let D=y[b].length;D--;){const u=y[b][D][0].clone(),N=y[b][D][1],K=y[b][D][2],V=y[b][D][3],Yt=y[b][D][4];u.name=b,u.tag=Yt,N&&u.position.set(N[0],N[1],N[2]),K&&u.rotation.set(K[0],K[1],K[2]),V&&u.scale.set(V[0],V[1],V[2]),u.updateMatrix();const ht=u.geometry.clone();ht.applyMatrix4(u.matrix),u.geometry=ht,u.renderOrder=1/0,u.position.set(0,0,0),u.rotation.set(0,0,0),u.scale.set(1,1,1),U.add(u)}return U}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=E(Y)),this.add(this.gizmo.rotate=E(vt)),this.add(this.gizmo.scale=E(Qt)),this.add(this.picker.translate=E(Mt)),this.add(this.picker.rotate=E(It)),this.add(this.picker.scale=E(Xt)),this.add(this.helper.translate=E(xt)),this.add(this.helper.rotate=E(Et)),this.add(this.helper.scale=E(At)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(s){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:it;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let e=[];e=e.concat(this.picker[this.mode].children),e=e.concat(this.gizmo[this.mode].children),e=e.concat(this.helper[this.mode].children);for(let h=0;h<e.length;h++){const t=e[h];t.visible=!0,t.rotation.set(0,0,0),t.position.copy(this.worldPosition);let p;if(this.camera.isOrthographicCamera?p=(this.camera.top-this.camera.bottom)/this.camera.zoom:p=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),t.scale.set(1,1,1).multiplyScalar(p*this.size/4),t.tag==="helper"){t.visible=!1,t.name==="AXIS"?(t.visible=!!this.axis,this.axis==="X"&&(c.setFromEuler($.set(0,0,0)),t.quaternion.copy(n).multiply(c),Math.abs(l.copy(C).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Y"&&(c.setFromEuler($.set(0,0,Math.PI/2)),t.quaternion.copy(n).multiply(c),Math.abs(l.copy(Z).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Z"&&(c.setFromEuler($.set(0,Math.PI/2,0)),t.quaternion.copy(n).multiply(c),Math.abs(l.copy(G).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="XYZE"&&(c.setFromEuler($.set(0,Math.PI/2,0)),l.copy(this.rotationAxis),t.quaternion.setFromRotationMatrix(yt.lookAt(ft,l,Z)),t.quaternion.multiply(c),t.visible=this.dragging),this.axis==="E"&&(t.visible=!1)):t.name==="START"?(t.position.copy(this.worldPositionStart),t.visible=this.dragging):t.name==="END"?(t.position.copy(this.worldPosition),t.visible=this.dragging):t.name==="DELTA"?(t.position.copy(this.worldPositionStart),t.quaternion.copy(this.worldQuaternionStart),f.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),f.applyQuaternion(this.worldQuaternionStart.clone().invert()),t.scale.copy(f),t.visible=this.dragging):(t.quaternion.copy(n),this.dragging?t.position.copy(this.worldPositionStart):t.position.copy(this.worldPosition),this.axis&&(t.visible=this.axis.search(t.name)!==-1));continue}t.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(t.name==="X"&&Math.abs(l.copy(C).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Y"&&Math.abs(l.copy(Z).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Z"&&Math.abs(l.copy(G).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XY"&&Math.abs(l.copy(G).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="YZ"&&Math.abs(l.copy(C).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XZ"&&Math.abs(l.copy(Z).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1)):this.mode==="rotate"&&(tt.copy(n),l.copy(this.eye).applyQuaternion(c.copy(n).invert()),t.name.search("E")!==-1&&t.quaternion.setFromRotationMatrix(yt.lookAt(this.eye,ft,Z)),t.name==="X"&&(c.setFromAxisAngle(C,Math.atan2(-l.y,l.z)),c.multiplyQuaternions(tt,c),t.quaternion.copy(c)),t.name==="Y"&&(c.setFromAxisAngle(Z,Math.atan2(l.x,l.z)),c.multiplyQuaternions(tt,c),t.quaternion.copy(c)),t.name==="Z"&&(c.setFromAxisAngle(G,Math.atan2(l.y,l.x)),c.multiplyQuaternions(tt,c),t.quaternion.copy(c))),t.visible=t.visible&&(t.name.indexOf("X")===-1||this.showX),t.visible=t.visible&&(t.name.indexOf("Y")===-1||this.showY),t.visible=t.visible&&(t.name.indexOf("Z")===-1||this.showZ),t.visible=t.visible&&(t.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),t.material._color=t.material._color||t.material.color.clone(),t.material._opacity=t.material._opacity||t.material.opacity,t.material.color.copy(t.material._color),t.material.opacity=t.material._opacity,this.enabled&&this.axis&&(t.name===this.axis||this.axis.split("").some(function(M){return t.name===M}))&&(t.material.color.setHex(16776960),t.material.opacity=1)}super.updateMatrixWorld(s)}}class Jt extends i{constructor(){super(new zt(1e5,1e5,2,2),new St({visible:!1,wireframe:!0,side:Dt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(s){let o=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(o="local"),et.copy(C).applyQuaternion(o==="local"?this.worldQuaternion:it),W.copy(Z).applyQuaternion(o==="local"?this.worldQuaternion:it),R.copy(G).applyQuaternion(o==="local"?this.worldQuaternion:it),l.copy(W),this.mode){case"translate":case"scale":switch(this.axis){case"X":l.copy(this.eye).cross(et),P.copy(et).cross(l);break;case"Y":l.copy(this.eye).cross(W),P.copy(W).cross(l);break;case"Z":l.copy(this.eye).cross(R),P.copy(R).cross(l);break;case"XY":P.copy(R);break;case"YZ":P.copy(et);break;case"XZ":l.copy(R),P.copy(W);break;case"XYZ":case"E":P.set(0,0,0);break}break;case"rotate":default:P.set(0,0,0)}P.length()===0?this.quaternion.copy(this.cameraQuaternion):(_t.lookAt(f.set(0,0,0),P,l),this.quaternion.setFromRotationMatrix(_t)),super.updateMatrixWorld(s)}}const j=document.querySelector("#app"),nt=new qt;nt.add(new Lt(5));const X=new kt(75,window.innerWidth/window.innerHeight,.1,1e3);X.position.z=2;const F=new Wt;F.setSize(window.innerWidth,window.innerHeight);j==null||j.appendChild(F.domElement);const $t=new d,te=new Rt,Pt=new i($t,te);nt.add(Pt);const O=new Ot(X,F.domElement);O.attach(Pt);nt.add(O);window.addEventListener("keydown",function(r){switch(r.code){case"KeyG":O.setMode("translate");break;case"KeyR":O.setMode("rotate");break;case"KeyS":O.setMode("scale");break}});window.addEventListener("resize",ie,!1);const ee=ne();oe();rt();gt();function gt(){requestAnimationFrame(gt),ee.update(),rt()}function rt(){F.render(nt,X)}function ie(){X.aspect=window.innerWidth/window.innerHeight,X.updateProjectionMatrix(),F.setSize(window.innerWidth,window.innerHeight),rt()}function ne(){const r=new Ct;return j==null||j.appendChild(r.dom),r}function oe(){const r=document.querySelector("#gui");if(!r)return;const o=new Gt({container:r}).addFolder("Camera");o.add(X.position,"x",-10,10,.01),o.add(X.position,"y",-10,10,.01),o.add(X.position,"z",-10,10,.01)}
