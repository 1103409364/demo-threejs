/* empty css              */import{C as D,ag as X,ah as Y,c as q,ad as x,S as O,A as V,a0 as Z,P as $,W as J,ap as K,m as Q,s as E,k as ee,D as te,a as ne}from"./three.module-d5fa3ebf.js";import{O as se}from"./OrbitControls-5742bab2.js";import{S as re}from"./Stats-ef6ecf20.js";import{G as oe}from"./lil-gui.esm-fc0b5e43.js";import{g as z}from"./index-21dc82eb.js";const I=new D;class ie extends X{constructor(u){super(u),this.propertyNameMapping={},this.customPropertyMapping={}}load(u,g,R,S){const _=this,f=new Y(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(u,function(M){try{g(_.parse(M))}catch(b){S?S(b):console.error(b),_.manager.itemError(u)}},R,S)}setPropertyNameMapping(u){this.propertyNameMapping=u}setCustomPropertyNameMapping(u){this.customPropertyMapping=u}parse(u){function g(e){const o=/^ply([\s\S]*)end_header(\r\n|\r|\n)/;let t="",n=0;const s=o.exec(e);s!==null&&(t=s[1],n=new Blob([s[0]]).size);const r={comments:[],elements:[],headerLength:n,objInfo:""},a=t.split(/\r\n|\r|\n/);let i;function m(l,p){const c={type:l[0]};return c.type==="list"?(c.name=l[3],c.countType=l[1],c.itemType=l[2]):c.name=l[1],c.name in p&&(c.name=p[c.name]),c}for(let l=0;l<a.length;l++){let p=a[l];if(p=p.trim(),p==="")continue;const c=p.split(/\s+/),h=c.shift();switch(p=c.join(" "),h){case"format":r.format=c[0],r.version=c[1];break;case"comment":r.comments.push(p);break;case"element":i!==void 0&&r.elements.push(i),i={},i.name=c[0],i.count=parseInt(c[1]),i.properties=[];break;case"property":i.properties.push(m(c,w.propertyNameMapping));break;case"obj_info":r.objInfo=p;break;default:console.log("unhandled",h,c)}}return i!==void 0&&r.elements.push(i),r}function R(e,o){switch(o){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function S(e,o){const t=o.split(/\s+/),n={};for(let s=0;s<e.length;s++)if(e[s].type==="list"){const r=[],a=R(t.shift(),e[s].countType);for(let i=0;i<a;i++)r.push(R(t.shift(),e[s].itemType));n[e[s].name]=r}else n[e[s].name]=R(t.shift(),e[s].type);return n}function _(){const e={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};for(const o of Object.keys(w.customPropertyMapping))e[o]=[];return e}function f(e){const o=e.map(n=>n.name);function t(n){for(let s=0,r=n.length;s<r;s++){const a=n[s];if(o.includes(a))return a}return null}return{attrX:t(["x","px","posx"])||"x",attrY:t(["y","py","posy"])||"y",attrZ:t(["z","pz","posz"])||"z",attrNX:t(["nx","normalx"]),attrNY:t(["ny","normaly"]),attrNZ:t(["nz","normalz"]),attrS:t(["s","u","texture_u","tx"]),attrT:t(["t","v","texture_v","ty"]),attrR:t(["red","diffuse_red","r","diffuse_r"]),attrG:t(["green","diffuse_green","g","diffuse_g"]),attrB:t(["blue","diffuse_blue","b","diffuse_b"])}}function M(e,o){const t=_();let n;const s=/end_header\s([\s\S]*)$/;let r="";(n=s.exec(e))!==null&&(r=n[1]);const a=r.split(/\r\n|\r|\n/);let i=0,m=0,l=o.elements[i],p=f(l.properties);for(let c=0;c<a.length;c++){let h=a[c];if(h=h.trim(),h==="")continue;m>=l.count&&(i++,m=0,l=o.elements[i],p=f(l.properties));const W=S(l.properties,h);N(t,l.name,W,p),m++}return b(t)}function b(e){let o=new q;e.indices.length>0&&o.setIndex(e.indices),o.setAttribute("position",new x(e.vertices,3)),e.normals.length>0&&o.setAttribute("normal",new x(e.normals,3)),e.uvs.length>0&&o.setAttribute("uv",new x(e.uvs,2)),e.colors.length>0&&o.setAttribute("color",new x(e.colors,3)),e.faceVertexUvs.length>0&&(o=o.toNonIndexed(),o.setAttribute("uv",new x(e.faceVertexUvs,2)));for(const t of Object.keys(w.customPropertyMapping))e[t].length>0&&o.setAttribute(t,new x(e[t],w.customPropertyMapping[t].length));return o.computeBoundingSphere(),o}function N(e,o,t,n){if(o==="vertex"){e.vertices.push(t[n.attrX],t[n.attrY],t[n.attrZ]),n.attrNX!==null&&n.attrNY!==null&&n.attrNZ!==null&&e.normals.push(t[n.attrNX],t[n.attrNY],t[n.attrNZ]),n.attrS!==null&&n.attrT!==null&&e.uvs.push(t[n.attrS],t[n.attrT]),n.attrR!==null&&n.attrG!==null&&n.attrB!==null&&(I.setRGB(t[n.attrR]/255,t[n.attrG]/255,t[n.attrB]/255).convertSRGBToLinear(),e.colors.push(I.r,I.g,I.b));for(const s of Object.keys(w.customPropertyMapping))for(const r of w.customPropertyMapping[s])e[s].push(t[r])}else if(o==="face"){const s=t.vertex_indices||t.vertex_index,r=t.texcoord;s.length===3?(e.indices.push(s[0],s[1],s[2]),r&&r.length===6&&(e.faceVertexUvs.push(r[0],r[1]),e.faceVertexUvs.push(r[2],r[3]),e.faceVertexUvs.push(r[4],r[5]))):s.length===4&&(e.indices.push(s[0],s[1],s[3]),e.indices.push(s[1],s[2],s[3]))}}function U(e,o){const t={};let n=0;for(let s=0;s<o.length;s++){const r=o[s],a=r.valueReader;if(r.type==="list"){const i=[],m=r.countReader.read(e+n);n+=r.countReader.size;for(let l=0;l<m;l++)i.push(a.read(e+n)),n+=a.size;t[r.name]=i}else t[r.name]=a.read(e+n),n+=a.size}return[t,n]}function k(e,o,t){function n(s,r,a){switch(r){case"int8":case"char":return{read:i=>s.getInt8(i),size:1};case"uint8":case"uchar":return{read:i=>s.getUint8(i),size:1};case"int16":case"short":return{read:i=>s.getInt16(i,a),size:2};case"uint16":case"ushort":return{read:i=>s.getUint16(i,a),size:2};case"int32":case"int":return{read:i=>s.getInt32(i,a),size:4};case"uint32":case"uint":return{read:i=>s.getUint32(i,a),size:4};case"float32":case"float":return{read:i=>s.getFloat32(i,a),size:4};case"float64":case"double":return{read:i=>s.getFloat64(i,a),size:8}}}for(let s=0,r=e.length;s<r;s++){const a=e[s];a.type==="list"?(a.countReader=n(o,a.countType,t),a.valueReader=n(o,a.itemType,t)):a.valueReader=n(o,a.type,t)}}function H(e,o){const t=_(),n=o.format==="binary_little_endian",s=new DataView(e,o.headerLength);let r,a=0;for(let i=0;i<o.elements.length;i++){const m=o.elements[i],l=m.properties,p=f(l);k(l,s,n);for(let c=0;c<m.count;c++){r=U(a,l),a+=r[1];const h=r[0];N(t,m.name,h,p)}}return b(t)}function F(e){let o=0,t=!0,n="";const s=[];do{const r=String.fromCharCode(e[o++]);r!==`
`&&r!=="\r"?n+=r:(n==="end_header"&&(t=!1),n!==""&&(s.push(n),n=""))}while(t&&o<e.length);return s.join("\r")+"\r"}let C;const w=this;if(u instanceof ArrayBuffer){const e=new Uint8Array(u),o=F(e),t=g(o);if(t.format==="ascii"){const n=new TextDecoder().decode(e);C=M(n,t)}else C=H(u,t)}else C=M(u,g(u));return C}}const v=document.querySelector("#app"),T=new O;T.add(new V(5));const B=new Z;B.position.set(20,20,20);T.add(B);const y=new $(75,window.innerWidth/window.innerHeight,.1,1e3);y.position.z=40;const P=new J;P.outputEncoding=K;P.setSize(window.innerWidth,window.innerHeight);v==null||v.appendChild(P.domElement);const L=new se(y,P.domElement);L.enableDamping=!0;const j=new Q().load([z("px_50"),z("nx_50"),z("py_50"),z("ny_50"),z("pz_50"),z("nz_50")]);j.mapping=E;const ae=new ee({color:11730888,envMap:j,metalness:0,roughness:0,transparent:!0,transmission:1,side:te,clearcoat:1,clearcoatRoughness:.25}),ce=new ie;ce.load("/assets/models/sean4.ply",function(d){d.computeVertexNormals();const u=new ne(d,ae);u.rotateX(-Math.PI/2),T.add(u)},d=>{console.log(d.loaded/d.total*100+"% loaded")},d=>{console.log(d)});window.addEventListener("resize",ue,!1);const le=pe();de();A();G();function G(){requestAnimationFrame(G),L.update(),le.update(),A()}function A(){P.render(T,y)}function ue(){y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),P.setSize(window.innerWidth,window.innerHeight),A()}function pe(){const d=new re;return v==null||v.appendChild(d.dom),d}function de(){const d=document.querySelector("#gui");if(!d)return;const g=new oe({container:d}).addFolder("Camera");g.add(y.position,"x",-10,10,.01),g.add(y.position,"y",-10,10,.01),g.add(y.position,"z",-10,10,.01)}
